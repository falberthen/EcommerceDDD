<div class="card fadeInDown stored-events-viewer">
  <div class="card-body">
    <div class="viewer-header">
      <span class="viewer-title">Event History</span>
      <button (click)="close()" class="btn btn-sm btn-outline-secondary">Close</button>
    </div>

    @if (eventHistory && eventHistory.length === 0) {
      <div class="alert alert-warning mt-2">No events to display</div>
    }

    <div class="event-timeline">
      @for (event of eventHistory; track $index) {
        <div class="event-entry">
          <div class="event-dot"></div>
          <div class="event-content">
            <div class="event-header">
              <span class="event-name">{{ formatEventName(event.eventTypeName) }}</span>
              <span class="event-time">{{ event.timestamp | date:'MMM d, y, HH:mm' }}</span>
            </div>
            <div class="event-fields">
              @for (field of parseEventData(event.eventData); track field.key) {
                <div class="event-field">
                  <span class="field-key">{{ formatKey(field.key) }}</span>
                  <span class="field-value">{{ field.value }}</span>
                </div>
              }
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>
